$((function(){var a;function removeCont(){$(".jsThumbAppend, .jsPrdThumb, .jsWriter, .jsCont").empty(),$(".detail-pagination, .swiper-notification, .modal-info .prd-name, .modal-info .prd-view").remove()}function closeModal(){$(".modal").removeClass("on"),$(".modal-score").attr("class","modal-score score"),$(".modal-right").removeClass("scroll"),setTimeout((function(){removeCont(),$(".modal-header").css("opacity",1)}),300)}!function getPrAll(){$.ajax({url:"/moa/import/board/ptrv_data.html",dataType:"html",success:function(a){$(a).find(".jsRvItem").each((function(){var a=$(this),t=a.data("read-link").replace(/(\S*)[?&]no=(\d+)(\S*)/g,"$2");$.ajax({url:"/exec/front/Board/Get",dataType:"json",data:{no:t,board_no:4},success:function(t){if(t.data.content_image)a.appendTo($(".jsPrApd")),a.attr("data-list-no",t.data.no),$(".jsPrApd").find(".jsRvItem").addClass("swiper-slide"),$(".jsReviewSlide").addClass("swiper-container").end().find(".jsPrApd").addClass("swiper-wrapper");else{var e=t.data.content,n=/(<im[^>]+)(src)(\s*=\s*['"][^'"]+['"][^>]*>)/;(e.match(n)?$(e.match(n)[0]).attr("src"):undefined)&&(a.appendTo($(".jsPrApd")),a.attr("data-list-no",t.data.no),$(".jsPrApd").find(".jsRvItem").addClass("swiper-slide"),$(".jsReviewSlide").addClass("swiper-container").end().find(".jsPrApd").addClass("swiper-wrapper"))}}})})),function runPrAll(){var a,t=undefined,e=document.querySelector(".jsPrApd"),n=new MutationObserver((function(e){e.forEach((function(e){t||(setTimeout((function(){if((a=$(".jsPrApd").find(".jsRvItem").toArray()).sort((function(a,t){return $(a).data("list-no")>$(t).data("list-no")?-1:$(a).data("list-no")<$(t).data("list-no")?1:0})),$(".jsPrApd").html(""),$.each(a,(function(a,t){$(".jsPrApd").append(t)})),$(".jsReviewSlide").addClass("on"),$(".jsReviewSlide").find(".swiper-slide").length>4){$(".review-nav__btn").addClass("on");new Swiper(".jsReviewSlide",{loop:!0,slidesPerView:"auto",simulateTouch:!1,navigation:{nextEl:".jsReviewNext",prevEl:".jsReviewPrev"}})}}),1e3),t=!0),function chkNotLinkPrd(){$(".jsRvItem").each((function(){""==$(this).find(".prd-name").find("a").text()&&$(this).find(".prd-info").css("opacity",0)}))}()}))})),i={attributes:!0,childList:!0,characterData:!0};n.observe(e,i)}(),setTimeout((function(){!function setHoverImg(){$(".jsReviewItem").each((function(){var a=$(this),t=a.find(".thumb__img--attach"),e=a.data("idx").split("&"),n=(e=e[0].split("no="))[1];if(a.attr("data-idx",n),n=parseInt(n),$.ajax({url:"/exec/front/Board/Get",dataType:"json",data:{no:n,board_no:4},success:function(e){if(e.data.content_image){e.data.content_image;if(a.hasClass("thumb")&&$(a[0].children[2])[0]){var n=$($($(a[0].children[2])[0].innerHTML)[0]).attr("src");$(a[0].children[2]).attr("style","background-image: url("+n+")")}}else{var i=e.data.content,d=/(<im[^>]+)(src)(\s*=\s*['"][^'"]+['"][^>]*>)/,s=i.match(d)?$(i.match(d)[0]).attr("src"):undefined;t.attr("style","background-image: url("+s+");")}}}),$(this).hasClass("description")){var i=$(this).find(".content");if(i.text().length>45){var d=i.text().substr(0,45);i.text(d+"...")}}}))}()}),500)}})}(),function dummySet(){$(".jsDummy").each((function(){var a=$(this).data("idx").split("&"),t=(a=a[0].split("no="))[1];$(this).attr("data-idx",t)}))}(),$(document).on("click",".jsReviewItem",(function(){var t=$(this).closest(".main-review__item"),e=$(this)[0].dataset.idx;(function viewReview(t,e){removeCont(),$.ajax({url:"/exec/front/Board/Get",dataType:"json",data:{no:e,board_no:4},success:function(n){if(n.data.content_image){var i=n.data.content_image;$(".jsThumbAppend").append(i).find("br").remove().end().find("img")}else{var d=n.data.content;$(".modal").append(d),$(".modal").find("img").each((function(){$(this).appendTo($(".jsThumbAppend"))})),setTimeout((function(){$(".modal-cont").find("img").hide()}),0)}var s=n.data.writer,o=n.data.subject,r=n.data.content,l=n.data.point_count,c=t.find(".prd-name").find("a").attr("href");$(".modal").attr("data-idx",e),$(".jsThumbAppend").find("img").each((function(){var a=$($(this)[0]).attr("src");$(this).wrap('<div class="modal-attach-img swiper-slide"></div>').hide(),$(this).parent("div").attr("style","background-image: url("+a+");")})),$(".jsThumbAppend").after('<div class="detail-pagination"></div>'),$(".jsWriter").append(s),$(".jsCont").prepend('<div class="modal-subject jsSubject">'+o+"</div>"),$(".jsCont").append(r),$(".modal-score").addClass("score"+l),t.find(".prd-thumb").clone().appendTo(".jsPrdThumb"),t.find(".prd-name").clone().prependTo(".modal-info"),$(".modal-info").append('<a class="prd-view" href="'+c+'">상품 상세보기</a>'),""==$(".modal-info").find(".prd-name").find("a").text()&&$(".modal-header").css("opacity",0),$(".modal").addClass("on"),setTimeout((function(){$(".modal-right").addClass("scroll")}),500),a&&a.destroy(),$(".jsThumbAppend").find(".swiper-slide").length>1&&(a=new Swiper(".jsThumbSlide",{loop:!0,slidesPerView:"auto",pagination:{el:$(".detail-pagination")[0]},navigation:{nextEl:".jsViewNext",prevEl:".jsViewPrev"}}))}})})(t,e=parseInt(e))})),$(".jsModalClose").on("click",closeModal),$(".modal").on("click",(function(a){$(a.target).is(".modal-popup, .modal-popup *")||closeModal()})),history.pushState(null,null,location.href),window.onpopstate=function(){$(".modal").hasClass("on")&&(history.go(1),closeModal())}}));